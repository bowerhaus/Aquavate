; PlatformIO Project Configuration File
; Aquavate Smart Water Bottle Firmware
;
; Build commands:
;   pio run                           # Build default (Adafruit Feather)
;   pio run -e sparkfun_qwiic         # Build for SparkFun Qwiic
;   pio run -e adafruit_feather -t upload  # Upload to Adafruit board

[platformio]
default_envs = adafruit_feather
src_dir = src
include_dir = include
lib_dir = lib
test_dir = test

; Common settings for all environments
[env]
framework = arduino
monitor_speed = 115200
lib_deps =
    adafruit/Adafruit NAU7802 Library@^1.0.0
    adafruit/Adafruit ADXL343@^1.3.0
    adafruit/Adafruit BusIO@^1.14.0
    adafruit/RTClib@^2.1.0
    h2zero/NimBLE-Arduino@^1.4.0

; Adafruit ESP32 Feather V2 with 2.13" E-Paper FeatherWing
[env:adafruit_feather]
platform = espressif32
board = adafruit_feather_esp32_v2
build_flags =
    -DBOARD_ADAFRUIT_FEATHER
    -DDISPLAY_FEATHERWING_213
    -DCORE_DEBUG_LEVEL=0
    ; IRAM optimization - move WiFi/BT to flash
    -DESP32_WIFI_DYNAMIC_TX_BUFFER_NUM=4
    -DESP32_WIFI_DYNAMIC_RX_BUFFER_NUM=4
    -DESP32_WIFI_STATIC_TX_BUFFER_NUM=0
    -DESP32_WIFI_STATIC_RX_BUFFER_NUM=0
    -mno-target-align
    -ffunction-sections
    -fdata-sections
board_build.partitions = partitions.csv
lib_deps =
    ${env.lib_deps}
    adafruit/Adafruit EPD@^4.5.0
    adafruit/Adafruit GFX Library@^1.11.0

; SparkFun ESP32-C6 Qwiic Pocket with Waveshare 1.54" E-Paper
; NOTE: ESP32-C6 Arduino support requires pioarduino platform
; NOTE: NimBLE not yet compatible with ESP32-C6, using built-in BLE later
[env:sparkfun_qwiic]
platform = https://github.com/pioarduino/platform-espressif32/releases/download/53.03.10/platform-espressif32.zip
board = esp32-c6-devkitc-1
upload_port = /dev/cu.usbmodem1B701
build_flags =
    -DBOARD_SPARKFUN_QWIIC
    -DDISPLAY_WAVESHARE_154
    -DCORE_DEBUG_LEVEL=3
lib_deps =
    adafruit/Adafruit NAU7802 Library@^1.0.0
    adafruit/Adafruit ADXL343@^1.3.0
    adafruit/Adafruit BusIO@^1.14.0
    zinggjm/GxEPD2@^1.5.0
    adafruit/Adafruit GFX Library@^1.11.0
